[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "数据可视化探索(从入门到放弃)",
    "section": "",
    "text": "Preface\n数据可视化,对王师傅来说是很复杂的东西\n所以王师傅特地写了这个笔记,来记录学习过程和心得体会。\n看似简单,其实一点也不难.\n遗憾的是,由于王师傅打字不认真,书中的中文标点符号几乎都是错误的.\n这本书是由quarto生成的,可以在quarto.org上了解更多.\n王师傅强烈推荐 r graph gallery 的数据可视化思路:",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "快速入门.html",
    "href": "快速入门.html",
    "title": "1  快速入门",
    "section": "",
    "text": "1.1 基本概念\n现在有下面这张表格，记录了钻石相关的一些信息：\nShow/Hide Code\nlibrary(tidyverse)\ndiamonds &lt;- diamonds |&gt; filter(carat &lt; 3)\nknitr::kable(head(diamonds))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncarat\ncut\ncolor\nclarity\ndepth\ntable\nprice\nx\ny\nz\n\n\n\n\n0.23\nIdeal\nE\nSI2\n61.5\n55\n326\n3.95\n3.98\n2.43\n\n\n0.21\nPremium\nE\nSI1\n59.8\n61\n326\n3.89\n3.84\n2.31\n\n\n0.23\nGood\nE\nVS1\n56.9\n65\n327\n4.05\n4.07\n2.31\n\n\n0.29\nPremium\nI\nVS2\n62.4\n58\n334\n4.20\n4.23\n2.63\n\n\n0.31\nGood\nJ\nSI2\n63.3\n58\n335\n4.34\n4.35\n2.75\n\n\n0.24\nVery Good\nJ\nVVS2\n62.8\n57\n336\n3.94\n3.96\n2.48\n其中:\n这是数据分析的整体流程:",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>快速入门</span>"
    ]
  },
  {
    "objectID": "快速入门.html#基本概念",
    "href": "快速入门.html#基本概念",
    "title": "1  快速入门",
    "section": "",
    "text": "变量（Variable）：列, carat、cut、color、clarity、depth、table、price、x、y、z\n\n连续变量（Continuous Variable）：carat、depth、table、price、x、y、z\n离散变量（Discrete Variable）：cut、color、clarity\n分类变量（Categorical Variable）：cut、color、clarity\n\n观测（Observation）：行, 每个钻石的记录\n值（Value）：单元格, 如某个钻石的carat为1.5\n数据框（Data Frame）：整个表格\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nwhich part of the data analysis process is the most interesting? Which part is the most boring?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>快速入门</span>"
    ]
  },
  {
    "objectID": "快速入门.html#单变量univariate-variable",
    "href": "快速入门.html#单变量univariate-variable",
    "title": "1  快速入门",
    "section": "1.2 单变量(Univariate Variable)",
    "text": "1.2 单变量(Univariate Variable)\n\n1.2.1 分类变量(Categorical Variable)\n对于分类变量，我们主要展示其比例构成。\n\n1.2.1.1 饼图(Pie)\n不得不说，饼图是最常见的单个分类变量可视化方式，那么直接，又那么简单。\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = 1, fill = cut)) + \n  geom_bar(color = \"white\") + \n  coord_polar(theta = \"y\") + \n  theme_void()\n\n\n\n\n\n\n\n\n\n\n\n1.2.1.2 甜甜圈图(Donut)\n甜甜圈图是饼图的变种，去掉了中间的空心部分，形成一个甜甜圈形状。\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = 2, fill = cut)) + \n  geom_bar(color = \"white\") +\n  xlim(0.5, 2.5) +  # 这里设置中心空白洞的大小\n  coord_polar(theta = \"y\") + \n  theme_void()\n\n\n\n\n\n\n\n\n\n\n\n1.2.1.3 堆叠条形图(Barstack)\n堆叠条形图是另一种常见的单个分类变量可视化方式(我不喜欢,我觉得它不直观)\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = 1, fill = cut)) + \n  geom_bar(color = \"white\") + \n  theme_classic()\n\n\n\n\n\n\n\n\n\n\n\n\n1.2.2 连续性变量（Continuous Variable）\n对于连续变量, 我们主要关注其变化、分布、趋势、典型值、异常值\n\n1.2.2.1 直方图(Histogram)\n下图是 53900 个钻石的克拉数分布，X轴是克拉数，Y轴是频数。\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat)) +\n  geom_histogram(binwidth = 0.5) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nWhat do you notice from the histogram?\n\n\n让我们改变一下 binwidth 的大小，看看会有什么不同。\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat)) +\n  geom_histogram(binwidth = 0.1) \n\n\n\n\n\n\n\n\n\n好像有些不一样了，继续改变 binwidth 的大小：\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat)) +\n  geom_histogram(binwidth = 0.01) \n\n\n\n\n\n\n\n\n\nAmazing!\n\n\n\n\n\n\n思考题\n\n\n\nWhy are there more diamonds at whole carats and common fractions of carats?\nWhy are there more diamonds slightly to the right of each peak than there are slightly to the left of each peak?\n\n\n\n\n1.2.2.2 密度曲线图(Density)\n密度曲线图可以帮助我们更好地理解数据的分布情况。下图是钻石克拉数的密度曲线图，X轴是克拉数，Y轴是分布密度,\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat)) +\n  geom_density()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nWhat is the density?\nWhat is the relationship between the density curve and the histogram above?\n\n\n\n\n1.2.2.3 箱线图(Boxplot)\n箱线图是用来展示数据分布的图形，主要用于显示数据的中位数、四分位数、异常值等信息。 \n\n\n\n\n\n\n思考题\n\n\n\nHow to interpret this boxplot?\n\n\n\n\n1.2.2.4 小提琴图(Violin)\n箱线图很好,但仅展示了四分位数等,而小提琴图则显示了数据的分布密度,可以更好地展示数据的分布情况。\n\n\nShow/Hide Code\nggplot(diamonds |&gt; filter(cut == \"Fair\"), aes(x = cut, y = carat)) +\n  geom_violin() \n\n\n\n\n\n\n\n\n\n小提琴图显示分布密度\n\n\n\n\n\n\n思考题\n\n\n\nwhat is the difference in the three plots(boxplot, density plot, histogram)?\n\n\n下图很地解释了直方图、密度曲线图和箱线图这三者之前的关系\n\n\nShow/Hide Code\nlibrary(patchwork)\n## Left\np_left &lt;- ggplot(diamonds, aes(x = carat)) +\n  geom_histogram(binwidth = 0.1)\n\n## Middle\np_middle &lt;- ggplot(diamonds, aes(x = carat)) +\n  geom_density()\n\n## Right\np_right &lt;- ggplot(diamonds, aes(x = carat)) +\n  geom_boxplot()\n\np_left + p_middle + p_right\n\n\n\n\n\n\n\n\n\n\n\n1.2.2.5 小提琴图(Violin) + 箱线图(Boxplot)\n还有一种把小提琴图和箱线图结合的方式，近年来在科研界比较流行。\n\n\nShow/Hide Code\nggplot(diamonds |&gt; filter(cut == \"Fair\"), aes(x = cut, y = carat)) +\n  geom_violin() +\n  geom_boxplot(width = 0.1, fill = \"white\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nHow to interpret this plot?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>快速入门</span>"
    ]
  },
  {
    "objectID": "快速入门.html#双变量bivariate-variable",
    "href": "快速入门.html#双变量bivariate-variable",
    "title": "1  快速入门",
    "section": "1.3 双变量(Bivariate Variable)",
    "text": "1.3 双变量(Bivariate Variable)\n\n1.3.1 分类-数值变量(A categorical and a numerical variable)\n\n1.3.1.1 折线图(Line)\n下面是不同切割质量的钻石的价格情况的折线图\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = price, color = cut)) + \n  geom_freqpoly(binwidth = 500, linewidth = 0.75)\n\n\n\n\n\n\n\n\n\n不好看!\n\n\n\n\n\n\n思考题\n\n\n\nWhy is this plot ugly?\n\n\n\n\n1.3.1.2 密度曲线图(Density)\n当各组数据差得较多时,纵轴用count不太合适,会造成摩天大厦+小平层,不如把纵轴改为density:\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = price, y = after_stat(density), color = cut)) + \n  geom_freqpoly(binwidth = 500, linewidth = 0.75)\n\n\n\n\n\n\n\n\n\n好多了吧 ●‘◡’● (好吧,还是有点丑)\n分面(facet)会好一点吗?\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = price, fill = cut)) + \n  geom_density() + \n  facet_wrap(~ cut, nrow = 1) + \n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n1.3.1.3 山脊图(Ridge)\n近年来还流行一种“山脊图(Ridge)”，它可以更好地展示多个分布的重叠情况。\n\n\nShow/Hide Code\nlibrary(ggridges)\nggplot(diamonds, aes(x = price, y = cut, fill = cut)) + \n  geom_density_ridges(alpha = 0.5) + \n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n1.3.1.4 并排箱线图(Boxplot)\n箱线图也是一种直观的可视化方式\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = cut, y = price)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n\n或许还可以上点颜色, 让它显得花里胡哨:\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = cut, y = price, fill = cut)) +\n  geom_boxplot(outlier.shape = NA) +\n  theme(legend.position = \"none\") + \n  coord_cartesian(ylim = c(0, 15000))\n\n\n\n\n\n\n\n\n\n等等,这不对吧,cut越好的钻石价格应该越高才对啊!!!怎么回事?\n\n\n\n\n\n\n思考题\n\n\n\nWhy does the boxplot show that the price of diamonds with “Fair” cut is higher than those with “Ideal” cut?\n\n\n\n\n1.3.1.5 折线图(Line)\n还有一种策略,是算出数值的平均数(或其他特征),然后绘制折线图:\n\n\nShow/Hide Code\ndiamonds |&gt;\n  group_by(cut) |&gt;\n  summarise(price = mean(price)) |&gt;\n  ggplot(aes(x = cut, y = price, color = cut)) +\n  geom_point() +\n  geom_line(group = 1) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n\n1.3.2 两个分类变量(Two categorical variables)\n虽然听起来有点离谱,但有时候确实需要可视化两个分类变量之间的关系.\n\n1.3.2.1 点图(Dot)\n下图是一个点图，展示了钻石的切割质量和颜色之间的关系。点的大小表示组合的数量\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = cut, y = color)) +\n  geom_count()\n\n\n\n\n\n\n\n\n\n好看吗? 好像还行。\n\n\n1.3.2.2 色块图(Tile)\n让我们再来换一种表达形式——色块图,色块的颜色表示组合的数量.\n\n\nShow/Hide Code\ndiamonds |&gt; \n  count(color, cut) |&gt;  \n  ggplot(aes(x = color, y = cut)) +\n  geom_tile(aes(fill = n))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nWhich one do you prefer, the dot plot or the tile plot? Why?\n\n\n\n\n1.3.2.3 堆叠条形图(Barstack)\n又到了我不喜欢的堆叠条形图了. 下面两个图是钻石的颜色和切割质量的堆叠条形图，分别展示了每种颜色的钻石在不同切割质量下的数量分布。\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = color, fill = cut)) +\n  geom_bar()\n\n\n\n\n\n\n\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = color, fill = cut)) +\n  geom_bar(position = \"fill\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nWhat is the difference between the two stacked bar charts?\n\n\n\n\n1.3.2.4 分面面包圈图(Facet Donut)\n其实就是多个面包圈图组合在一起,用ppt也能做.\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = 1, fill = color)) +\n  geom_bar(color = \"white\") + \n  xlim(-0.5, 1.5) + \n  coord_polar(theta = \"y\") + \n  theme_void() + \n  facet_wrap(~ cut, scales=\"free_y\", nrow = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n1.3.3 两个数值变量(Two numerical variables)\n\n1.3.3.1 散点图(Scatter)\n下图是钻石的克拉数和价格之间的散点图，X轴是克拉数，Y轴是价格。\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat, y = price)) +\n  geom_point()\n\n\n\n\n\n\n\n\n\n黑色一大片,简直丑死了! 来调整一下点的透明度吧\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat, y = price)) +\n  geom_point(alpha = 0.02)\n\n\n\n\n\n\n\n\n\n稍微好一点,但是还有一些更好的策略.\n\n\n1.3.3.2 分格散点图(bin)\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat, y = price)) +\n  geom_bin2d()\n\n\n\n\n\n\n\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat, y = price)) +\n  geom_hex()\n\n\n\n\n\n\n\n\n\n\n\n1.3.3.3 排序箱线图(Order Boxplot)\n把其中一个变量分成若干个区间,然后在每个区间内绘制箱线图,可以更好地展示数据的分布情况.\n\n\nShow/Hide Code\nggplot(diamonds, aes(x = carat, y = price)) + \n  geom_boxplot(aes(group = cut_width(carat, 0.1)))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nWhen do you think a Order Boxplot Plot is useful?\n\n\n\n\n1.3.3.4 散点图(Scatter) + 线性回归(Linear Regression)\n换一个数据较少的例子,这是一个散点图，展示了汽车的发动机排量和高速公路油耗之间的关系。红色的点表示2座跑车。\n\n\nShow/Hide Code\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  geom_point(\n    data = mpg |&gt; filter(class == \"2seater\"),\n    color = \"red\"\n  ) +\n  geom_point(\n    data = mpg |&gt; filter(class == \"2seater\"),\n    shape = \"circle open\", size = 3, color = \"red\"\n  )\n\n\n\n\n\n\n\n\n\n我们还可以在散点图上添加线性回归线,来展示两者之间的关系.\n\n\nShow/Hide Code\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  geom_smooth()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n思考题\n\n\n\nWhat is the curve? What is the shadow around it?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>快速入门</span>"
    ]
  },
  {
    "objectID": "快速入门.html#三变量",
    "href": "快速入门.html#三变量",
    "title": "1  快速入门",
    "section": "1.4 三变量",
    "text": "1.4 三变量\nThe author will update this section if he remembers it…",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>快速入门</span>"
    ]
  },
  {
    "objectID": "箱线图.html",
    "href": "箱线图.html",
    "title": "2  箱线图",
    "section": "",
    "text": "2.1 箱线图陷阱\n箱线图又叫盒须图，展示数据的中位数(median)、上下四分位数(Quartiles)、四分位距(IQR)、须线(Whiskers)和异常值(outlier)。\n这是说明箱线图构成的示意图：\n但是，这种信息的总结也有个大问题——无法显示数据的分布情况。例如：正态分布可能看起来与双峰分布完全相同。因此，考虑用小提琴图或脊线图。\nShow/Hide Code\nlibrary(tidyverse)\nlibrary(hrbrthemes) # hrbrthemes 提供了更适合排版的主题\nlibrary(viridis) # viridis 提供了好看的色盲友好型颜色\n\n# 创建数据集\ndata1 &lt;- data.frame(\n  name = c(\n    rep(\"A\", 500),\n    rep(\"B\", 250),\n    rep(\"B\", 250),\n    rep(\"C\", 20),\n    rep('D', 100)\n  ),\n  value = c(\n    rnorm(500, 10, 5),\n    rnorm(250, 13, 1),\n    rnorm(250, 18, 1),\n    rnorm(20, 25, 4),\n    rnorm(100, 12, 1)\n  )\n)\n\ndata1 |&gt; \n  ggplot(aes(x = name, y = value, fill = name)) +\n  geom_boxplot() +\n  scale_fill_viridis(discrete = TRUE) + # 好看的色盲友好型颜色,离散变量\n  theme_ipsum() + # 更适合排版的主题\n  theme(legend.position = \"none\") + \n  labs(x = \"\") + \n  ggtitle(\"A somewhat misleading boxplot\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>箱线图</span>"
    ]
  },
  {
    "objectID": "箱线图.html#改进",
    "href": "箱线图.html#改进",
    "title": "2  箱线图",
    "section": "2.2 改进",
    "text": "2.2 改进\n\n2.2.1 添加抖动(Jitter)\n适合数据量不太大的情况\n\n\nShow/Hide Code\ndata1 |&gt; \n  ggplot( aes(x=name, y=value, fill=name)) +\n    geom_boxplot() +\n    scale_fill_viridis(discrete = TRUE) +  # 好看的色盲友好型颜色,离散变量\n    geom_jitter(color=\"grey\", size=0.5, alpha=0.5) +\n    theme_ipsum() + # 更适合排版的主题\n    theme(legend.position=\"none\") +\n    labs(x = \"\") + \n    ggtitle(\"A boxplot with jitter\")\n\n\n\n\n\n添加抖动(jitter)的箱线图\n\n\n\n\n发现:\n\n组 C 样本量小。在得出组 C 的值高于其他组的结论之前，要考虑样本量.\n组 B 呈现出双峰分布(y = 18 和 y = 13),但是箱线图中看起来和组 A 并无区别.\n\n\n\n2.2.2 小提琴图(Violin)\n\n\nShow/Hide Code\n# 显示样本量\nsample_size = data1 |&gt; group_by(name) |&gt; summarize(num = n())\n\ndata1  |&gt;\n  left_join(sample_size) |&gt;\n  mutate(myaxis = paste0(name, \"\\n\", \"n=\", num)) |&gt;\n  ggplot(aes(x = myaxis, y = value, fill = name)) +\n  geom_violin(width = 1.4) +\n  geom_boxplot(width = 0.1, color = \"grey\", alpha = 0.2) +\n  scale_fill_viridis(discrete = TRUE) +\n  theme_ipsum() +\n  theme(legend.position = \"none\") +\n  labs(x = \"\") + \n  ggtitle(\"A violin plot\")\n\n\n\n\n\n\n\n\n\n\n\n2.2.3 云雨图(Raincloud)\n看了就知道,云(半小提琴)+雨(散点)的组合。\n\n\nShow/Hide Code\nlibrary(ggdist) # ggdist 提供了半小提琴图和云雨图\nlibrary(hrbrthemes) # hrbrthemes 提供了更适合排版的主题\nlibrary(viridis) # viridis 提供了好看的色盲友好型颜色\n\ndata1 |&gt;\n    ggplot(aes(x = factor(name), y = value, fill = factor(name))) +\n\n    # 添加半小提琴图（显示分布）\n    stat_halfeye(\n        adjust = 0.5,\n        justification = -0.1,\n        .width = 0,\n        point_colour = NA\n    ) +\n\n    # 添加散点（显示原始数据点）\n    stat_dots(\n        side = \"left\",\n        justification = 1.1,\n        binwidth = 0.25\n    ) +\n\n    # 设置色盲友好型配色\n    scale_fill_viridis(discrete = TRUE) +\n    theme_ipsum() +\n    theme(legend.position = \"none\") + \n    labs(x = \"\") +\n    ggtitle(\"A raincloud plot example\") \n\n\n\n\n\n\n\n\n\n把头顺时针旋转90度(或交换R代码X轴和Y轴)，就更像云雨了\n甚至还可以再加上箱线图\n\n\nShow/Hide Code\nlibrary(ggdist) # ggdist 提供了半小提琴图和云雨图\nlibrary(hrbrthemes) # hrbrthemes 提供了更适合排版的主题\nlibrary(viridis) # viridis 提供了好看的色盲友好型颜色\n\ndata1 |&gt;\n    ggplot(aes(x = factor(name), y = value, fill = factor(name))) +\n\n    # 添加半小提琴图（显示分布）\n    stat_halfeye(\n        adjust = 0.5,\n        justification = -0.2,\n        .width = 0,\n        point_colour = NA\n    ) +\n\n    # 添加箱线图\n    geom_boxplot(\n        width = 0.12,\n        outlier.color = NA,\n        alpha = 0.5\n    ) +\n\n    # 添加散点（显示原始数据点）\n    stat_dots(\n        side = \"left\",\n        justification = 1.1,\n        binwidth = 0.25\n    ) +\n\n    # 设置色盲友好型配色\n    scale_fill_viridis(discrete = TRUE) +\n    theme_ipsum() +\n    theme(legend.position = \"none\") + \n    labs(x = \"\") +\n    ggtitle(\"A raincloud plot example\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>箱线图</span>"
    ]
  },
  {
    "objectID": "箱线图.html#ggplot2",
    "href": "箱线图.html#ggplot2",
    "title": "2  箱线图",
    "section": "2.3 ggplot2",
    "text": "2.3 ggplot2\n主要是geom_boxplot()函数.\n\n\nShow/Hide Code\nggplot(mpg, aes(x = class, y = hwy)) + \n    geom_boxplot()\n\n\n\n\n\n最基础的箱线图\n\n\n\n\n\n\nShow/Hide Code\nggplot(mpg, aes(x=class, y=hwy)) + \n  geom_boxplot(\n    color=\"blue\",         # 箱线图边框颜色为蓝色\n    fill=\"blue\",          # 箱体填充颜色为蓝色\n    alpha=0.2,            # 箱体透明度为0.2，便于观察重叠部分\n    \n    notch=TRUE,           # 显示缺口，用于比较中位数是否有显著差异\n    notchwidth = 0.8,     # 缺口的宽度\n    \n    outlier.colour=\"red\", # 异常值点的边框颜色为红色\n    outlier.fill=\"red\",   # 异常值点的填充颜色为红色\n    outlier.size=1        # 异常值点的大小为3\n  )\n\n\n\n\n\n有细腰的箱线图\n\n\n\n\n\n\nShow/Hide Code\nmpg |&gt;\n  # fct_reorder() 函数排序\n  ggplot( aes(x=fct_reorder(class, hwy, .fun='median'), y=hwy)) + \n    geom_boxplot()\n\n\n\n\n\n用均值排序箱线图\n\n\n\n\n\n\nShow/Hide Code\nlibrary(patchwork)\n \np1 &lt;- ggplot(mpg, aes(x=class, y=hwy)) + \n    geom_boxplot(color=\"red\", fill=\"orange\", alpha=0.2)\n \np2 &lt;- ggplot(mpg, aes(x=class, y=hwy, fill=class)) + \n    geom_boxplot(alpha=0.3) +\n    theme(legend.position=\"none\")\n\np3 &lt;- ggplot(mpg, aes(x=class, y=hwy, fill=class)) + \n    geom_boxplot(alpha=0.3) +\n    theme(legend.position=\"none\") +\n    scale_fill_brewer(palette=\"BuPu\") # 调色板\n \np4 &lt;- ggplot(mpg, aes(x=class, y=hwy, fill=class)) + \n    geom_boxplot(alpha=0.3) +\n    theme(legend.position=\"none\") +\n    scale_fill_brewer(palette=\"Dark2\") # 调色板\n\np1 + p2 + p3 + p4\n\n\n\n\n\n改变颜色\n\n\n\n\n\n\nShow/Hide Code\nlibrary(hrbrthemes)\n\nmpg |&gt; \n  # 添加一列 'type'，用于标记是否高亮某个组\n  mutate(type = ifelse(class == \"subcompact\", \"Highlighted\", \"Normal\")) |&gt;\n  \n  ggplot(aes(x = class, y = hwy, fill = type, alpha = type)) + \n    geom_boxplot() + \n    scale_fill_manual(values = c(\"#69b3a2\", \"grey\")) + # 手动设置填充色，高亮组为绿色，其余为灰色\n    scale_alpha_manual(values = c(1, 0.1)) + # 手动设置透明度，高亮组为不透明，其余为半透明\n    theme_ipsum() + # 使用 hrbrthemes 包的排版主题\n    theme(legend.position = \"none\") + # 不显示图例\n    xlab(\"\") # 去除 x 轴标签\n\n\n\n\n\n高亮某个组\n\n\n\n\n\n\nShow/Hide Code\nlibrary(patchwork)\n#| fig-cap: 分组箱线图与分面箱线图\n# 构造数据\nvariety = rep(LETTERS[1:7], each = 40) # 7种品种，每种40个观测\ntreatment = rep(c(\"high\", \"low\"), each = 20) # 处理分为high和low，每组20个观测\nnote = seq(1:280) + sample(1:150, 280, replace = TRUE) # 生成note变量，添加一定随机性\ndata2 = data.frame(variety, treatment, note) # 组合成数据框\n\n# 分组箱线图\nggplot(data2, aes(x = variety, y = note, fill = treatment)) + \n  geom_boxplot()\n\n\n\n\n\n\n\n\n\nShow/Hide Code\n# 少分面箱线图\nggplot(data2, aes(x=variety, y=note, fill=treatment)) + \n    geom_boxplot() +\n    facet_wrap(~treatment)\n\n\n\n\n\n\n\n\n\nShow/Hide Code\n# 多分面箱线图\nggplot(data2, aes(x=variety, y=note, fill=treatment)) + \n    geom_boxplot() +\n    facet_wrap(~variety, scale=\"free\") # 自由y轴\n\n\n\n\n\n\n\n\n\n\n\nShow/Hide Code\n# 转换为因子类型\nmpg$drv &lt;- as.factor(mpg$drv) \n# 创建x轴标签，包含每个drv水平的名称及其对应的样本量\nn_xlab &lt;- str_glue(\"{levels(mpg$drv)}\\n(N={table(mpg$drv)})\")\n\nggplot(mpg, aes(x = drv, y = hwy, fill = drv)) + \n    geom_boxplot(varwidth = TRUE, alpha = 0.2) + # varwidth = TRUE 不等宽\n    scale_x_discrete(labels = n_xlab) + \n    theme(legend.position = \"none\")\n\n\n\n\n\n不等宽箱线图(宽带是样本量)\n\n\n\n\n\n\nShow/Hide Code\ndiamonds |&gt;\n  mutate(bin = cut_width(carat, width = 0.5, boundary = 0)) |&gt;\n  ggplot(aes(x = bin, y = price)) +\n  geom_boxplot() \n\n\n\n\n\n连续变量箱线图\n\n\n\n\n\n\nShow/Hide Code\nggplot(mpg, aes(x=drv, y=hwy, fill=drv)) +\n    geom_boxplot(alpha=0.7) +\n    stat_summary(fun.y=mean, geom=\"point\", shape=1, size=2, color = 'red') +\n    theme(legend.position=\"none\") \n\n\n\n\n\n添加均值点\n\n\n\n\n\n\nShow/Hide Code\n# data1 是之前创建的数据集\ndata1 |&gt; \n  ggplot( aes(x=name, y=value, fill=name)) +\n    geom_boxplot() +\n    scale_fill_viridis(discrete = TRUE) +  # 好看的色盲友好型颜色,离散变量\n    geom_jitter(color=\"grey\", size=0.5, alpha=0.5) +\n    theme_ipsum() + # 更适合排版的主题\n    theme(legend.position=\"none\") +\n    labs(x = \"\") + \n    ggtitle(\"A boxplot with jitter\")\n\n\n\n\n\n带抖动的箱线图\n\n\n\n\n可以library(ggExtra)来实现更复杂（花哨）的图形，在ggplot2散点图的基础上再叠加箱线图、密度曲线等。\n\n\nShow/Hide Code\nlibrary(ggExtra)\n# 创建ggplot散点图\np &lt;- ggplot(mtcars, aes(x = wt, y = mpg, color = cyl, size = cyl)) +\n  geom_point() +\n  theme(legend.position = \"none\")\n\nggMarginal(p, type = \"histogram\")\n\n\n\n\n\nggMarginal散点图叠加直方图\n\n\n\n\n\n\nShow/Hide Code\nggMarginal(p, type = \"density\")\n\n\n\n\n\nggMarginal散点图叠加密度图\n\n\n\n\n\n\nShow/Hide Code\nggMarginal(p, type = \"boxplot\")\n\n\n\n\n\nggMarginal散点图叠加箱线图\n\n\n\n\n还可以定制化样式：\n\n\nShow/Hide Code\n# 设置边际直方图的尺寸大小为10\nggMarginal(p, type = \"histogram\", size = 10)\n\n\n\n\n\nggMarginal定制化样式-尺寸大小\n\n\n\n\n\n\nShow/Hide Code\n# 设置边际直方图的填充颜色为slateblue，x轴直方图分箱数为10\nggMarginal(p, type = \"histogram\", fill = \"slateblue\", xparams = list(bins = 10))\n\n\n\n\n\nggMarginal定制化样式-颜色和分箱\n\n\n\n\n\n\nShow/Hide Code\n# 只在x轴添加边际图，边际图颜色为紫色，尺寸为4\nggMarginal(p, margins = 'x', color = \"purple\", size = 4)\n\n\n\n\n\nggMarginal定制化样式-颜色和尺寸",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>箱线图</span>"
    ]
  },
  {
    "objectID": "箱线图.html#base-r",
    "href": "箱线图.html#base-r",
    "title": "2  箱线图",
    "section": "2.4 Base R",
    "text": "2.4 Base R\n主要是通过boxplot()函数.\n但是 base R 多看一秒都是浪费时间,直接ggplot2吧.\n如果实在想学,可以看 r-graph-gallery 的文档。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>箱线图</span>"
    ]
  },
  {
    "objectID": "箱线图.html#pearl",
    "href": "箱线图.html#pearl",
    "title": "2  箱线图",
    "section": "2.5 Pearl",
    "text": "2.5 Pearl\n\n\nShow/Hide Code\npalmerpenguins::penguins |&gt;\n  drop_na() |&gt;\n  ggstatsplot::ggbetweenstats(x = species, y = flipper_length_mm, 1)\n\n\n\n\n\n带有统计的小提琴箱线图\n\n\n\n\n在 ggstatsplot 可以看到进一步美化。\n或者\n在 tidyplots 有另一种风格的统计箱线图。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>箱线图</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "3  总结",
    "section": "",
    "text": "In summary, this book has no content whatsoever.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>总结</span>"
    ]
  }
]